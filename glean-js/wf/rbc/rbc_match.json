{"id": "RBC_Match","name": "RBC Matching","composed": false,"node_type": "composite_task","workflow_state": "activeState","decisional_state": "chosenState","children": [{"id": "check_routine_match","name": "Routine match?","composed": true,"in_workflow": "RBC_Match","node_type": "decision_task","workflow_state": "inactiveState","decisional_state": "chosenState","description": "Does this constitute a routine match or an emergency (e.g., massive hemorrhage)?","inputForm": "<table><tr><td property='http:\/\/hl7.org\/fhir\/DiagnosticReport.result' typeof=''><span style='display: none' property='http:\/\/hl7.org\/fhir\/Observation.code' resource='http:\/\/niche.cs.dal.ca\/ns\/cig\/rbc_match.owl#code_routine_match'><\/span><div id='code_routine_match' property='http:\/\/hl7.org\/fhir\/Observation.valueBoolean'>Routine match?: <label><input type='radio' name='code_routine_match' id='code_routine_match-yes' code='code_routine_match-yes' value='yes' \/>yes<\/label>&nbsp;&nbsp;<label><input type='radio' name='code_routine_match' id='code_routine_match-no' code='code_routine_match-no' value='no' \/>no<\/label><\/div><\/td><\/tr><\/table>","children": [{"id": "match_abo_rhd","name": "Match ABO & RhD","composed": false,"in_workflow": "RBC_Match","node_type": "atomic_task","workflow_state": "inactiveState","decisional_state": "chosenState","condition": {"label": "routine","description": "A non-emergency routine RBC request"},"description": "Match RBC units for ABO and RhD","children": [{"id": "match_antibody","name": "Match antibodies","composed": false,"in_workflow": "RBC_Match","node_type": "atomic_task","workflow_state": "inactiveState","decisional_state": "chosenState","description": "Match RBC units for antibodies","children": [{"id": "check_need_irr_blood","name": "Need irradiated blood?","composed": false,"in_workflow": "RBC_Match","node_type": "decision_task","workflow_state": "inactiveState","decisional_state": "chosenState","description": "Does the patient require irradiated blood?","inputForm": "<table><tr><td property='http:\/\/hl7.org\/fhir\/DiagnosticReport.result' typeof=''><span style='display: none' property='http:\/\/hl7.org\/fhir\/Observation.code' resource='http:\/\/niche.cs.dal.ca\/ns\/cig\/rbc_match.owl#code_irr_blood'><\/span><div id='code_irr_blood' property='http:\/\/hl7.org\/fhir\/Observation.valueBoolean'>Need irradiated blood?: <label><input type='radio' name='code_irr_blood' id='code_irr_blood-yes' code='code_irr_blood-yes' value='yes' \/>yes<\/label>&nbsp;&nbsp;<label><input type='radio' name='code_irr_blood' id='code_irr_blood-no' code='code_irr_blood-no' value='no' \/>no<\/label><\/div><\/td><\/tr><\/table>","children": [{"id": "match_irr_blood","name": "Match irradiated blood","composed": false,"in_workflow": "RBC_Match","node_type": "atomic_task","workflow_state": "inactiveState","decisional_state": "chosenState","condition": {"label": "irradiated blood","description": "The patient requires irradiated blood"},"description": "Match irradiated RBC units","children": [{"hidden": true},{"id": "check_female_childbearing_age","name": "Female < 45?","composed": false,"in_workflow": "RBC_Match","otherParents": [{"id": "check_need_irr_blood","condition": {"label": "no","description": "The patient does not require irradiated blood"}}],"node_type": "decision_task","workflow_state": "inactiveState","decisional_state": "chosenState","description": "Is the patient a female of childbearing age (< 45)?","inputForm": "<table><tr><td property='http:\/\/hl7.org\/fhir\/DiagnosticReport.result' typeof=''><span style='display: none' property='http:\/\/hl7.org\/fhir\/Observation.code' resource='http:\/\/niche.cs.dal.ca\/ns\/cig\/rbc_match.owl#code_female_childbearing_age'><\/span><div id='code_female_childbearing_age' property='http:\/\/hl7.org\/fhir\/Observation.valueBoolean'>Female of childbearing age?: <label><input type='radio' name='code_female_childbearing_age' id='code_female_childbearing_age-yes' code='code_female_childbearing_age-yes' value='yes' \/>yes<\/label>&nbsp;&nbsp;<label><input type='radio' name='code_female_childbearing_age' id='code_female_childbearing_age-no' code='code_female_childbearing_age-no' value='no' \/>no<\/label><\/div><\/td><\/tr><\/table>","children": [{"id": "match_kell","name": "Match for Kell","composed": false,"in_workflow": "RBC_Match","node_type": "atomic_task","workflow_state": "inactiveState","decisional_state": "chosenState","condition": {"label": "yes","description": "Patient is a female of childbearing age (< 45)"},"description": "Match RBC units for Kell","children": [{"id": "check_kell_status","name": "Kell status?","composed": false,"in_workflow": "RBC_Match","node_type": "decision_task","workflow_state": "inactiveState","decisional_state": "chosenState","description": "What is the patient's Kell status?","inputForm": "<table><tr><td property='http:\/\/hl7.org\/fhir\/DiagnosticReport.result' typeof=''><span style='display: none' property='http:\/\/hl7.org\/fhir\/Observation.code' resource='http:\/\/niche.cs.dal.ca\/ns\/cig\/rbc_match.owl#code_kell_pos'><\/span><label><input type='checkbox' id='code_kell_pos' code='code_kell_pos' property='http:\/\/hl7.org\/fhir\/Observation.valueBoolean' mutex-with='code_kell_neg,code_kell_unknown' mandatory='false' \/>Kell positive<\/label><\/td><\/tr><tr><td property='http:\/\/hl7.org\/fhir\/DiagnosticReport.result' typeof=''><span style='display: none' property='http:\/\/hl7.org\/fhir\/Observation.code' resource='http:\/\/niche.cs.dal.ca\/ns\/cig\/rbc_match.owl#code_kell_neg'><\/span><label><input type='checkbox' id='code_kell_neg' code='code_kell_neg' property='http:\/\/hl7.org\/fhir\/Observation.valueBoolean' mutex-with='code_kell_pos,code_kell_unknown' mandatory='false' \/>Kell negative<\/label><\/td><\/tr><tr><td property='http:\/\/hl7.org\/fhir\/DiagnosticReport.result' typeof=''><span style='display: none' property='http:\/\/hl7.org\/fhir\/Observation.code' resource='http:\/\/niche.cs.dal.ca\/ns\/cig\/rbc_match.owl#code_kell_unknown'><\/span><label><input type='checkbox' id='code_kell_unknown' code='code_kell_unknown' property='http:\/\/hl7.org\/fhir\/Observation.valueBoolean' mutex-with='code_kell_pos,code_kell_neg' mandatory='false' \/>Kell unknown<\/label><\/td><\/tr><\/table>","children": [{"id": "match_kell_neg","name": "Match Kell -","composed": false,"in_workflow": "RBC_Match","node_type": "atomic_task","workflow_state": "inactiveState","decisional_state": "chosenState","condition": {"label": "- or unknown","description": "Patient is Kell negative or unknown"},"description": "Match Kell - RBC units","children": [{"hidden": true},{"id": "check_phenotype_avail","name": "Phenotype available?","composed": false,"in_workflow": "RBC_Match","otherParents": [{"id": "check_female_childbearing_age","condition": {"label": "no","description": "Patient is not a female of childbearing age (< 45)"}}, {"id": "check_kell_status","condition": {"label": "+","description": "Patient is Kell positive"}}],"node_type": "decision_task","workflow_state": "inactiveState","decisional_state": "chosenState","description": "Is the patient's phenotype available?","inputForm": "<table><tr><td property='http:\/\/hl7.org\/fhir\/DiagnosticReport.result' typeof=''><span style='display: none' property='http:\/\/hl7.org\/fhir\/Observation.code' resource='http:\/\/niche.cs.dal.ca\/ns\/cig\/rbc_match.owl#code_blood_phenotype_avail'><\/span><div id='code_blood_phenotype_avail' property='http:\/\/hl7.org\/fhir\/Observation.valueBoolean'>Phenotype available?: <label><input type='radio' name='code_blood_phenotype_avail' id='code_blood_phenotype_avail-yes' code='code_blood_phenotype_avail-yes' value='yes' \/>yes<\/label>&nbsp;&nbsp;<label><input type='radio' name='code_blood_phenotype_avail' id='code_blood_phenotype_avail-no' code='code_blood_phenotype_avail-no' value='no' \/>no<\/label><\/div><\/td><\/tr><\/table>","children": [{"id": "check_need_phenotype_match","name": "Need for phenotype match?","composed": false,"in_workflow": "RBC_Match","node_type": "decision_task","workflow_state": "inactiveState","decisional_state": "chosenState","condition": {"label": "yes","description": "The patient's phenotype is available"},"description": "Consider the following factors for phenotype matching:\n\t\t1) Unique antibodies?\n\t\t2) Female of childbearing age (< 45)?\n\t\t3) Chronic transfusion case?\n\t\t4) Sickle cell disease?\n\tThe outcome of this task will be a weighted sum of the above factors. If this weighted sum lies above a certain threshold, there is a determined need for phenotype matching.","inputForm": "<table><tr><td property='http:\/\/hl7.org\/fhir\/DiagnosticReport.result' typeof=''><span style='display: none' property='http:\/\/hl7.org\/fhir\/Observation.code' resource='http:\/\/niche.cs.dal.ca\/ns\/cig\/rbc_match.owl#code_unique_antibody'><\/span><label><input type='checkbox' id='code_unique_antibody' code='code_unique_antibody' property='http:\/\/hl7.org\/fhir\/Observation.valueBoolean' mutex-with='' mandatory='false' \/>Unique antibodies?<\/label><\/td><\/tr><tr><td property='http:\/\/hl7.org\/fhir\/DiagnosticReport.result' typeof=''><span style='display: none' property='http:\/\/hl7.org\/fhir\/Observation.code' resource='http:\/\/niche.cs.dal.ca\/ns\/cig\/rbc_match.owl#code_female_childbearing_age'><\/span><label><input type='checkbox' id='code_female_childbearing_age' code='code_female_childbearing_age' property='http:\/\/hl7.org\/fhir\/Observation.valueBoolean' mutex-with='' mandatory='false' \/>Female of childbearing age (< 45)?<\/label><\/td><\/tr><tr><td property='http:\/\/hl7.org\/fhir\/DiagnosticReport.result' typeof=''><span style='display: none' property='http:\/\/hl7.org\/fhir\/Observation.code' resource='http:\/\/niche.cs.dal.ca\/ns\/cig\/rbc_match.owl#code_chronic_transf'><\/span><label><input type='checkbox' id='code_chronic_transf' code='code_chronic_transf' property='http:\/\/hl7.org\/fhir\/Observation.valueBoolean' mutex-with='' mandatory='false' \/>Chronic transfusion case?<\/label><\/td><\/tr><tr><td property='http:\/\/hl7.org\/fhir\/DiagnosticReport.result' typeof=''><span style='display: none' property='http:\/\/hl7.org\/fhir\/Observation.code' resource='http:\/\/niche.cs.dal.ca\/ns\/cig\/rbc_match.owl#code_sickle_cell'><\/span><label><input type='checkbox' id='code_sickle_cell' code='code_sickle_cell' property='http:\/\/hl7.org\/fhir\/Observation.valueBoolean' mutex-with='' mandatory='false' \/>Sickle cell disease?<\/label><\/td><\/tr><\/table>","children": [{"id": "do_phenotype_match","name": "Match phenotype","composed": false,"in_workflow": "RBC_Match","node_type": "atomic_task","workflow_state": "inactiveState","decisional_state": "chosenState","condition": {"label": "phenotype match","description": "There is a determined need for phenotype matching."},"description": "Perform phenotype matching for this patient based on their antigens","children": [{"id": "check_multi_factor_match","name": "Multi-factor match","composed": false,"in_workflow": "RBC_Match","node_type": "decision_task","workflow_state": "inactiveState","decisional_state": "chosenState","description": "Find RBC units depending on multiple factors:\n\t1) Phenotype (antigen) match\n\t2) Expiry times\n\t3) Geographic location\n\tThe outcome of this task will be a weighted sum of the above factors for each RBC unit. An RBC unit will be chosen based on this weighted sum."}]},{"id": "no_need_phenotype_match","name": "No phenotype match","composed": false,"in_workflow": "RBC_Match","node_type": "endpoint","workflow_state": "inactiveState","decisional_state": "chosenState","condition": {"label": "no","description": "There is no determined need for phenotype matching."},"description": "There is no need to perform phenotype matching for this patient"}]},{"id": "no_possible_phenotype_match","name": "No phenotype match","composed": false,"in_workflow": "RBC_Match","node_type": "endpoint","workflow_state": "inactiveState","decisional_state": "chosenState","condition": {"label": "no","description": "The patient's phenotype is not available"},"description": "Not possible to perform phenotype matching for this patient"}]}]},{"hidden": true}]}]}]}]},{"hidden": true}]}]}]},{"id": "emergency_request","name": "Emergency request","composed": false,"in_workflow": "RBC_Match","node_type": "endpoint","workflow_state": "inactiveState","decisional_state": "chosenState","condition": {"label": "emergency","description": "An RBC request for an emergency (e.g., hemorrhage)"},"description": "This RBC request is for an emergency (e.g., hemorrhage) which is out of scope of this algorithm"}]}]}